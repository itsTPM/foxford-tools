name: main

on:
  workflow_dispatch:
  push:
    branches:
      - main
      - dev
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest
    name: Build extension & upload artifacts
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Fix zip script permissions
        run: chmod +x ./scripts/zip.sh
      - name: Run zip script
        run: ./scripts/zip.sh
      - uses: cardinalby/webext-buildtools-chrome-crx-action@v2
        with:
          zipFilePath: 'foxford-tools.zip'
          crxFilePath: 'foxford-tools.crx'
          privateKey: ${{ secrets.CHROME_CRX_PRIVATE_KEY }}
      - uses: actions/upload-artifact@v3
        with:
          name: chrome
          path: 'foxford-tools.crx'
