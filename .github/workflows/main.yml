name: main

on:
  workflow_dispatch:
  push:
    branches:
      - main
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest
    name: Build extension & upload artifacts
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Chmod
        run: chmod +x zip.sh
      - name: Zip
        run: ./zip.sh
      - uses: cardinalby/webext-buildtools-chrome-crx-action@v2
        with:
          zipFilePath: 'foxford-tools.zip'
          crxFilePath: 'foxford-tools.crx'
          privateKey: ${{ secrets.CHROME_CRX_PRIVATE_KEY }}
          updateXmlPath: 'update.xml'
          updateXmlCodebaseUrl: 'https://update.itstpm.tech/foxford-tools.crx'
      - uses: actions/upload-artifact@v3
        with:
          name: chrome
          path: 'foxford-tools.crx'
